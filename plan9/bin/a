#!/usr/bin/env bash

# an acme startup helper

d=$(dirname ${BASH_SOURCE[0]})

echo dir "${d}"

PAGER=nobs
EDITOR=E
TERM=dumb
PATH=$PATH:$PLAN9/bin:$d

[ "$1" = "-n" ] && { export NAMESPACE=/tmp/ns.$USER.$2; mkdir -p "$NAMESPACE"; shift 2; }

SIZE=13
[ "$1" = "-s" ] && { SIZE="$2"; shift 2; }

PLATFORM=$(uname)

FONTNAME="droidsansmono"
[ "$1" = "-fn" ] && { FONTNAME="$2"; shift 2; }
FONTARG="$HOME/lib/font/$FONTNAME/$FONTNAME.$SIZE.font"

if [ $PLATFORM == 'Darwin' ]
then
    FONTARG="/mnt/font/Menlo-Regular/11a/font"
fi

9p ls plumb >/dev/null 2>/dev/null || plumber

export acmeshell="bash"

exec acme -a -f $FONTARG "$@"
